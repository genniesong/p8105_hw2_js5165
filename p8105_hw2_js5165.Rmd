---
title: "p8105_hw2_js5165"
author: "Jingqi Song"
date: "September 26, 2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Problem 1

Import NYC transit data

```{r p1.1}
p1_nyc = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")%>%
  janitor::clean_names()%>%
  gather(key = route_no, value=route_name,route1:route11)%>%
  separate(route_no, into = c("x", "route_number"), sep = 5) %>%
  filter(!is.na(route_name))%>%
  select(line, station_name, station_latitude, station_longitude, route_number,route_name, entry, vending, entrance_type, ada)%>%
  mutate(entry=ifelse(entry=='YES',yes=TRUE,no=FALSE))%>%
  arrange(line,station_name)

```


The dataset variables contain line, name of station, the latitude and longtitude of station; the number and name of route; whether the station allows entrance and entrance type; whether the station has vending and ADA compliance.

Cleaning steps:
  I first cleaned up variable names after importing data and used gather function to transpose. Then I separated the single route number from the variable that the observations contain the word "route", and omitted observations without information of route number. After selecting the variables we need, I arranged the dataset by line and station name.
It is now a `r nrow(p1_nyc)` by `r ncol(p1_nyc)` tidy dataset.


```{r p1.2}
distinct_station = nrow(distinct(p1_nyc,station_name,line,.keep_all = TRUE))

ada_compliance = p1_nyc %>% 
  filter(ada == TRUE) %>% 
  distinct(station_name,line)
nrow(ada_compliance)

allow_entrance = p1_nyc %>% 
  filter(entry==TRUE & vending == 'NO') %>% 
  distinct(line,station_name)
vending = p1_nyc %>% 
  filter(vending == 'NO') %>% 
  distinct(line,station_name)
proportion = nrow(allow_entrance)/nrow(vending)
proportion

```

There are 465 distinct stations;
84 stations are ADA compliant;
43.43% of station entrances / exits without vending allow entrance.

```{r p1.3}
a_train = p1_nyc %>% 
  filter(route_name=='A') %>% 
  distinct(station_name,line)
nrow(a_train)

a_ada = p1_nyc %>% 
  filter(route_name=='A' & ada==TRUE) %>% 
  distinct(station_name,line)
nrow(a_ada)
```

60 distinct stations serve the A train;
of the stations that serve the A train, 17 are ADA compliant.
